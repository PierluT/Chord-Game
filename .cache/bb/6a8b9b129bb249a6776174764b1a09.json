{"id":"node_modules/teoria/lib/note.js","dependencies":[{"name":"C:\\Users\\pierl\\Desktop\\Actam\\ChordGame\\package.json","includedInParent":true,"mtime":1672854678203},{"name":"C:\\Users\\pierl\\Desktop\\Actam\\ChordGame\\node_modules\\teoria\\package.json","includedInParent":true,"mtime":1672854677580},{"name":"scientific-notation","loc":{"line":1,"column":25,"index":25},"parent":"C:\\Users\\pierl\\Desktop\\Actam\\ChordGame\\node_modules\\teoria\\lib\\note.js","resolved":"C:\\Users\\pierl\\Desktop\\Actam\\ChordGame\\node_modules\\scientific-notation\\index.js"},{"name":"helmholtz","loc":{"line":2,"column":24,"index":73},"parent":"C:\\Users\\pierl\\Desktop\\Actam\\ChordGame\\node_modules\\teoria\\lib\\note.js","resolved":"C:\\Users\\pierl\\Desktop\\Actam\\ChordGame\\node_modules\\helmholtz\\index.js"},{"name":"pitch-fq","loc":{"line":3,"column":22,"index":109},"parent":"C:\\Users\\pierl\\Desktop\\Actam\\ChordGame\\node_modules\\teoria\\lib\\note.js","resolved":"C:\\Users\\pierl\\Desktop\\Actam\\ChordGame\\node_modules\\pitch-fq\\index.js"},{"name":"./knowledge","loc":{"line":4,"column":24,"index":146},"parent":"C:\\Users\\pierl\\Desktop\\Actam\\ChordGame\\node_modules\\teoria\\lib\\note.js","resolved":"C:\\Users\\pierl\\Desktop\\Actam\\ChordGame\\node_modules\\teoria\\lib\\knowledge.js"},{"name":"./vector","loc":{"line":5,"column":21,"index":183},"parent":"C:\\Users\\pierl\\Desktop\\Actam\\ChordGame\\node_modules\\teoria\\lib\\note.js","resolved":"C:\\Users\\pierl\\Desktop\\Actam\\ChordGame\\node_modules\\teoria\\lib\\vector.js"},{"name":"./interval","loc":{"line":6,"column":23,"index":219},"parent":"C:\\Users\\pierl\\Desktop\\Actam\\ChordGame\\node_modules\\teoria\\lib\\note.js","resolved":"C:\\Users\\pierl\\Desktop\\Actam\\ChordGame\\node_modules\\teoria\\lib\\interval.js"}],"generated":{"js":"var scientific = require('scientific-notation');\nvar helmholtz = require('helmholtz');\nvar pitchFq = require('pitch-fq');\nvar knowledge = require('./knowledge');\nvar vector = require('./vector');\nvar Interval = require('./interval');\n\nfunction pad(str, ch, len) {\n  for (; len > 0; len--) {\n    str += ch;\n  }\n\n  return str;\n}\n\n\nfunction Note(coord, duration) {\n  if (!(this instanceof Note)) return new Note(coord, duration);\n  duration = duration || {};\n\n  this.duration = { value: duration.value || 4, dots: duration.dots || 0 };\n  this.coord = coord;\n}\n\nNote.prototype = {\n  octave: function() {\n    return this.coord[0] + knowledge.A4[0] - knowledge.notes[this.name()][0] +\n      this.accidentalValue() * 4;\n  },\n\n  name: function() {\n    var value = this.accidentalValue();\n    var idx = this.coord[1] + knowledge.A4[1] - value * 7 + 1;\n    return knowledge.fifths[idx];\n  },\n\n  accidentalValue: function() {\n    return Math.round((this.coord[1] + knowledge.A4[1] - 2) / 7);\n  },\n\n  accidental: function() {\n    return knowledge.accidentals[this.accidentalValue() + 2];\n  },\n\n  /**\n   * Returns the key number of the note\n   */\n  key: function(white) {\n    if (white)\n      return this.coord[0] * 7 + this.coord[1] * 4 + 29;\n    else\n      return this.coord[0] * 12 + this.coord[1] * 7 + 49;\n  },\n\n  /**\n  * Returns a number ranging from 0-127 representing a MIDI note value\n  */\n  midi: function() {\n    return this.key() + 20;\n  },\n\n  /**\n   * Calculates and returns the frequency of the note.\n   * Optional concert pitch (def. 440)\n   */\n  fq: function(concertPitch) {\n    return pitchFq(this.coord, concertPitch);\n  },\n\n  /**\n   * Returns the pitch class index (chroma) of the note\n   */\n  chroma: function() {\n    var value = (vector.sum(vector.mul(this.coord, [12, 7])) - 3) % 12;\n\n    return (value < 0) ? value + 12 : value;\n  },\n\n  interval: function(interval) {\n    if (typeof interval === 'string') interval = Interval.toCoord(interval);\n\n    if (interval instanceof Interval)\n      return new Note(vector.add(this.coord, interval.coord), this.duration);\n    else if (interval instanceof Note)\n      return new Interval(vector.sub(interval.coord, this.coord));\n  },\n\n  transpose: function(interval) {\n    this.coord = vector.add(this.coord, interval.coord);\n    return this;\n  },\n\n  /**\n   * Returns the Helmholtz notation form of the note (fx C,, d' F# g#'')\n   */\n  helmholtz: function() {\n    var octave = this.octave();\n    var name = this.name();\n    name = octave < 3 ? name.toUpperCase() : name.toLowerCase();\n    var padchar = octave < 3 ? ',' : '\\'';\n    var padcount = octave < 2 ? 2 - octave : octave - 3;\n\n    return pad(name + this.accidental(), padchar, padcount);\n  },\n\n  /**\n   * Returns the scientific notation form of the note (fx E4, Bb3, C#7 etc.)\n   */\n  scientific: function() {\n    return this.name().toUpperCase() + this.accidental() + this.octave();\n  },\n\n  /**\n   * Returns notes that are enharmonic with this note.\n   */\n  enharmonics: function(oneaccidental) {\n    var key = this.key(), limit = oneaccidental ? 2 : 3;\n\n    return ['m3', 'm2', 'm-2', 'm-3']\n      .map(this.interval.bind(this))\n      .filter(function(note) {\n      var acc = note.accidentalValue();\n      var diff = key - (note.key() - acc);\n\n      if (diff < limit && diff > -limit) {\n        var product = vector.mul(knowledge.sharp, diff - acc);\n        note.coord = vector.add(note.coord, product);\n        return true;\n      }\n    });\n  },\n\n  solfege: function(scale, showOctaves) {\n    var interval = scale.tonic.interval(this), solfege, stroke, count;\n    if (interval.direction() === 'down')\n      interval = interval.invert();\n\n    if (showOctaves) {\n      count = (this.key(true) - scale.tonic.key(true)) / 7;\n      count = (count >= 0) ? Math.floor(count) : -(Math.ceil(-count));\n      stroke = (count >= 0) ? '\\'' : ',';\n    }\n\n    solfege = knowledge.intervalSolfege[interval.simple(true).toString()];\n    return (showOctaves) ? pad(solfege, stroke, Math.abs(count)) : solfege;\n  },\n\n  scaleDegree: function(scale) {\n    var inter = scale.tonic.interval(this);\n\n    // If the direction is down, or we're dealing with an octave - invert it\n    if (inter.direction() === 'down' ||\n       (inter.coord[1] === 0 && inter.coord[0] !== 0)) {\n      inter = inter.invert();\n    }\n\n    inter = inter.simple(true).coord;\n\n    return scale.scale.reduce(function(index, current, i) {\n      var coord = Interval.toCoord(current).coord;\n      return coord[0] === inter[0] && coord[1] === inter[1] ? i + 1 : index;\n    }, 0);\n  },\n\n  /**\n   * Returns the name of the duration value,\n   * such as 'whole', 'quarter', 'sixteenth' etc.\n   */\n  durationName: function() {\n    return knowledge.durations[this.duration.value];\n  },\n\n  /**\n   * Returns the duration of the note (including dots)\n   * in seconds. The first argument is the tempo in beats\n   * per minute, the second is the beat unit (i.e. the\n   * lower numeral in a time signature).\n   */\n  durationInSeconds: function(bpm, beatUnit) {\n    var secs = (60 / bpm) / (this.duration.value / 4) / (beatUnit / 4);\n    return secs * 2 - secs / Math.pow(2, this.duration.dots);\n  },\n\n  /**\n   * Returns the name of the note, with an optional display of octave number\n   */\n  toString: function(dont) {\n    return this.name() + this.accidental() + (dont ? '' : this.octave());\n  }\n};\n\nNote.fromString = function(name, dur) {\n  var coord = scientific(name);\n  if (!coord) coord = helmholtz(name);\n  return new Note(coord, dur);\n};\n\nNote.fromKey = function(key) {\n  var octave = Math.floor((key - 4) / 12);\n  var distance = key - (octave * 12) - 4;\n  var name = knowledge.fifths[(2 * Math.round(distance / 2) + 1) % 7];\n  var subDiff = vector.sub(knowledge.notes[name], knowledge.A4);\n  var note = vector.add(subDiff, [octave + 1, 0]);\n  var diff = (key - 49) - vector.sum(vector.mul(note, [12, 7]));\n\n  var arg = diff ? vector.add(note, vector.mul(knowledge.sharp, diff)) : note;\n  return new Note(arg);\n};\n\nNote.fromFrequency = function(fq, concertPitch) {\n  var key, cents, originalFq;\n  concertPitch = concertPitch || 440;\n\n  key = 49 + 12 * ((Math.log(fq) - Math.log(concertPitch)) / Math.log(2));\n  key = Math.round(key);\n  originalFq = concertPitch * Math.pow(2, (key - 49) / 12);\n  cents = 1200 * (Math.log(fq / originalFq) / Math.log(2));\n\n  return { note: Note.fromKey(key), cents: cents };\n};\n\nNote.fromMIDI = function(note) {\n  return Note.fromKey(note - 20);\n};\n\nmodule.exports = Note;\n"},"sourceMaps":{"js":{"mappings":[{"source":"node_modules/teoria/lib/note.js","original":{"line":1,"column":0},"generated":{"line":1,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":2,"column":0},"generated":{"line":2,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":3,"column":0},"generated":{"line":3,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":4,"column":0},"generated":{"line":4,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":5,"column":0},"generated":{"line":5,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":6,"column":0},"generated":{"line":6,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":7,"column":0},"generated":{"line":7,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":8,"column":0},"generated":{"line":8,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":9,"column":0},"generated":{"line":9,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":10,"column":0},"generated":{"line":10,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":11,"column":0},"generated":{"line":11,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":12,"column":0},"generated":{"line":12,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":13,"column":0},"generated":{"line":13,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":14,"column":0},"generated":{"line":14,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":15,"column":0},"generated":{"line":15,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":16,"column":0},"generated":{"line":16,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":17,"column":0},"generated":{"line":17,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":18,"column":0},"generated":{"line":18,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":19,"column":0},"generated":{"line":19,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":20,"column":0},"generated":{"line":20,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":21,"column":0},"generated":{"line":21,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":22,"column":0},"generated":{"line":22,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":23,"column":0},"generated":{"line":23,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":24,"column":0},"generated":{"line":24,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":25,"column":0},"generated":{"line":25,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":26,"column":0},"generated":{"line":26,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":27,"column":0},"generated":{"line":27,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":28,"column":0},"generated":{"line":28,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":29,"column":0},"generated":{"line":29,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":30,"column":0},"generated":{"line":30,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":31,"column":0},"generated":{"line":31,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":32,"column":0},"generated":{"line":32,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":33,"column":0},"generated":{"line":33,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":34,"column":0},"generated":{"line":34,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":35,"column":0},"generated":{"line":35,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":36,"column":0},"generated":{"line":36,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":37,"column":0},"generated":{"line":37,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":38,"column":0},"generated":{"line":38,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":39,"column":0},"generated":{"line":39,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":40,"column":0},"generated":{"line":40,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":41,"column":0},"generated":{"line":41,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":42,"column":0},"generated":{"line":42,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":43,"column":0},"generated":{"line":43,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":44,"column":0},"generated":{"line":44,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":45,"column":0},"generated":{"line":45,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":46,"column":0},"generated":{"line":46,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":47,"column":0},"generated":{"line":47,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":48,"column":0},"generated":{"line":48,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":49,"column":0},"generated":{"line":49,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":50,"column":0},"generated":{"line":50,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":51,"column":0},"generated":{"line":51,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":52,"column":0},"generated":{"line":52,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":53,"column":0},"generated":{"line":53,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":54,"column":0},"generated":{"line":54,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":55,"column":0},"generated":{"line":55,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":56,"column":0},"generated":{"line":56,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":57,"column":0},"generated":{"line":57,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":58,"column":0},"generated":{"line":58,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":59,"column":0},"generated":{"line":59,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":60,"column":0},"generated":{"line":60,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":61,"column":0},"generated":{"line":61,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":62,"column":0},"generated":{"line":62,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":63,"column":0},"generated":{"line":63,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":64,"column":0},"generated":{"line":64,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":65,"column":0},"generated":{"line":65,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":66,"column":0},"generated":{"line":66,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":67,"column":0},"generated":{"line":67,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":68,"column":0},"generated":{"line":68,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":69,"column":0},"generated":{"line":69,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":70,"column":0},"generated":{"line":70,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":71,"column":0},"generated":{"line":71,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":72,"column":0},"generated":{"line":72,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":73,"column":0},"generated":{"line":73,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":74,"column":0},"generated":{"line":74,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":75,"column":0},"generated":{"line":75,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":76,"column":0},"generated":{"line":76,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":77,"column":0},"generated":{"line":77,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":78,"column":0},"generated":{"line":78,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":79,"column":0},"generated":{"line":79,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":80,"column":0},"generated":{"line":80,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":81,"column":0},"generated":{"line":81,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":82,"column":0},"generated":{"line":82,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":83,"column":0},"generated":{"line":83,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":84,"column":0},"generated":{"line":84,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":85,"column":0},"generated":{"line":85,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":86,"column":0},"generated":{"line":86,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":87,"column":0},"generated":{"line":87,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":88,"column":0},"generated":{"line":88,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":89,"column":0},"generated":{"line":89,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":90,"column":0},"generated":{"line":90,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":91,"column":0},"generated":{"line":91,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":92,"column":0},"generated":{"line":92,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":93,"column":0},"generated":{"line":93,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":94,"column":0},"generated":{"line":94,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":95,"column":0},"generated":{"line":95,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":96,"column":0},"generated":{"line":96,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":97,"column":0},"generated":{"line":97,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":98,"column":0},"generated":{"line":98,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":99,"column":0},"generated":{"line":99,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":100,"column":0},"generated":{"line":100,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":101,"column":0},"generated":{"line":101,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":102,"column":0},"generated":{"line":102,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":103,"column":0},"generated":{"line":103,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":104,"column":0},"generated":{"line":104,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":105,"column":0},"generated":{"line":105,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":106,"column":0},"generated":{"line":106,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":107,"column":0},"generated":{"line":107,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":108,"column":0},"generated":{"line":108,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":109,"column":0},"generated":{"line":109,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":110,"column":0},"generated":{"line":110,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":111,"column":0},"generated":{"line":111,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":112,"column":0},"generated":{"line":112,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":113,"column":0},"generated":{"line":113,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":114,"column":0},"generated":{"line":114,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":115,"column":0},"generated":{"line":115,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":116,"column":0},"generated":{"line":116,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":117,"column":0},"generated":{"line":117,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":118,"column":0},"generated":{"line":118,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":119,"column":0},"generated":{"line":119,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":120,"column":0},"generated":{"line":120,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":121,"column":0},"generated":{"line":121,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":122,"column":0},"generated":{"line":122,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":123,"column":0},"generated":{"line":123,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":124,"column":0},"generated":{"line":124,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":125,"column":0},"generated":{"line":125,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":126,"column":0},"generated":{"line":126,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":127,"column":0},"generated":{"line":127,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":128,"column":0},"generated":{"line":128,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":129,"column":0},"generated":{"line":129,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":130,"column":0},"generated":{"line":130,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":131,"column":0},"generated":{"line":131,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":132,"column":0},"generated":{"line":132,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":133,"column":0},"generated":{"line":133,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":134,"column":0},"generated":{"line":134,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":135,"column":0},"generated":{"line":135,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":136,"column":0},"generated":{"line":136,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":137,"column":0},"generated":{"line":137,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":138,"column":0},"generated":{"line":138,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":139,"column":0},"generated":{"line":139,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":140,"column":0},"generated":{"line":140,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":141,"column":0},"generated":{"line":141,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":142,"column":0},"generated":{"line":142,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":143,"column":0},"generated":{"line":143,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":144,"column":0},"generated":{"line":144,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":145,"column":0},"generated":{"line":145,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":146,"column":0},"generated":{"line":146,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":147,"column":0},"generated":{"line":147,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":148,"column":0},"generated":{"line":148,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":149,"column":0},"generated":{"line":149,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":150,"column":0},"generated":{"line":150,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":151,"column":0},"generated":{"line":151,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":152,"column":0},"generated":{"line":152,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":153,"column":0},"generated":{"line":153,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":154,"column":0},"generated":{"line":154,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":155,"column":0},"generated":{"line":155,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":156,"column":0},"generated":{"line":156,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":157,"column":0},"generated":{"line":157,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":158,"column":0},"generated":{"line":158,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":159,"column":0},"generated":{"line":159,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":160,"column":0},"generated":{"line":160,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":161,"column":0},"generated":{"line":161,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":162,"column":0},"generated":{"line":162,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":163,"column":0},"generated":{"line":163,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":164,"column":0},"generated":{"line":164,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":165,"column":0},"generated":{"line":165,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":166,"column":0},"generated":{"line":166,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":167,"column":0},"generated":{"line":167,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":168,"column":0},"generated":{"line":168,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":169,"column":0},"generated":{"line":169,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":170,"column":0},"generated":{"line":170,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":171,"column":0},"generated":{"line":171,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":172,"column":0},"generated":{"line":172,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":173,"column":0},"generated":{"line":173,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":174,"column":0},"generated":{"line":174,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":175,"column":0},"generated":{"line":175,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":176,"column":0},"generated":{"line":176,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":177,"column":0},"generated":{"line":177,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":178,"column":0},"generated":{"line":178,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":179,"column":0},"generated":{"line":179,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":180,"column":0},"generated":{"line":180,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":181,"column":0},"generated":{"line":181,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":182,"column":0},"generated":{"line":182,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":183,"column":0},"generated":{"line":183,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":184,"column":0},"generated":{"line":184,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":185,"column":0},"generated":{"line":185,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":186,"column":0},"generated":{"line":186,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":187,"column":0},"generated":{"line":187,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":188,"column":0},"generated":{"line":188,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":189,"column":0},"generated":{"line":189,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":190,"column":0},"generated":{"line":190,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":191,"column":0},"generated":{"line":191,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":192,"column":0},"generated":{"line":192,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":193,"column":0},"generated":{"line":193,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":194,"column":0},"generated":{"line":194,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":195,"column":0},"generated":{"line":195,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":196,"column":0},"generated":{"line":196,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":197,"column":0},"generated":{"line":197,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":198,"column":0},"generated":{"line":198,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":199,"column":0},"generated":{"line":199,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":200,"column":0},"generated":{"line":200,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":201,"column":0},"generated":{"line":201,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":202,"column":0},"generated":{"line":202,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":203,"column":0},"generated":{"line":203,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":204,"column":0},"generated":{"line":204,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":205,"column":0},"generated":{"line":205,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":206,"column":0},"generated":{"line":206,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":207,"column":0},"generated":{"line":207,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":208,"column":0},"generated":{"line":208,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":209,"column":0},"generated":{"line":209,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":210,"column":0},"generated":{"line":210,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":211,"column":0},"generated":{"line":211,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":212,"column":0},"generated":{"line":212,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":213,"column":0},"generated":{"line":213,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":214,"column":0},"generated":{"line":214,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":215,"column":0},"generated":{"line":215,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":216,"column":0},"generated":{"line":216,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":217,"column":0},"generated":{"line":217,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":218,"column":0},"generated":{"line":218,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":219,"column":0},"generated":{"line":219,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":220,"column":0},"generated":{"line":220,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":221,"column":0},"generated":{"line":221,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":222,"column":0},"generated":{"line":222,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":223,"column":0},"generated":{"line":223,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":224,"column":0},"generated":{"line":224,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":225,"column":0},"generated":{"line":225,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":226,"column":0},"generated":{"line":226,"column":0}},{"source":"node_modules/teoria/lib/note.js","original":{"line":227,"column":0},"generated":{"line":227,"column":0}}],"sources":{"node_modules/teoria/lib/note.js":"var scientific = require('scientific-notation');\nvar helmholtz = require('helmholtz');\nvar pitchFq = require('pitch-fq');\nvar knowledge = require('./knowledge');\nvar vector = require('./vector');\nvar Interval = require('./interval');\n\nfunction pad(str, ch, len) {\n  for (; len > 0; len--) {\n    str += ch;\n  }\n\n  return str;\n}\n\n\nfunction Note(coord, duration) {\n  if (!(this instanceof Note)) return new Note(coord, duration);\n  duration = duration || {};\n\n  this.duration = { value: duration.value || 4, dots: duration.dots || 0 };\n  this.coord = coord;\n}\n\nNote.prototype = {\n  octave: function() {\n    return this.coord[0] + knowledge.A4[0] - knowledge.notes[this.name()][0] +\n      this.accidentalValue() * 4;\n  },\n\n  name: function() {\n    var value = this.accidentalValue();\n    var idx = this.coord[1] + knowledge.A4[1] - value * 7 + 1;\n    return knowledge.fifths[idx];\n  },\n\n  accidentalValue: function() {\n    return Math.round((this.coord[1] + knowledge.A4[1] - 2) / 7);\n  },\n\n  accidental: function() {\n    return knowledge.accidentals[this.accidentalValue() + 2];\n  },\n\n  /**\n   * Returns the key number of the note\n   */\n  key: function(white) {\n    if (white)\n      return this.coord[0] * 7 + this.coord[1] * 4 + 29;\n    else\n      return this.coord[0] * 12 + this.coord[1] * 7 + 49;\n  },\n\n  /**\n  * Returns a number ranging from 0-127 representing a MIDI note value\n  */\n  midi: function() {\n    return this.key() + 20;\n  },\n\n  /**\n   * Calculates and returns the frequency of the note.\n   * Optional concert pitch (def. 440)\n   */\n  fq: function(concertPitch) {\n    return pitchFq(this.coord, concertPitch);\n  },\n\n  /**\n   * Returns the pitch class index (chroma) of the note\n   */\n  chroma: function() {\n    var value = (vector.sum(vector.mul(this.coord, [12, 7])) - 3) % 12;\n\n    return (value < 0) ? value + 12 : value;\n  },\n\n  interval: function(interval) {\n    if (typeof interval === 'string') interval = Interval.toCoord(interval);\n\n    if (interval instanceof Interval)\n      return new Note(vector.add(this.coord, interval.coord), this.duration);\n    else if (interval instanceof Note)\n      return new Interval(vector.sub(interval.coord, this.coord));\n  },\n\n  transpose: function(interval) {\n    this.coord = vector.add(this.coord, interval.coord);\n    return this;\n  },\n\n  /**\n   * Returns the Helmholtz notation form of the note (fx C,, d' F# g#'')\n   */\n  helmholtz: function() {\n    var octave = this.octave();\n    var name = this.name();\n    name = octave < 3 ? name.toUpperCase() : name.toLowerCase();\n    var padchar = octave < 3 ? ',' : '\\'';\n    var padcount = octave < 2 ? 2 - octave : octave - 3;\n\n    return pad(name + this.accidental(), padchar, padcount);\n  },\n\n  /**\n   * Returns the scientific notation form of the note (fx E4, Bb3, C#7 etc.)\n   */\n  scientific: function() {\n    return this.name().toUpperCase() + this.accidental() + this.octave();\n  },\n\n  /**\n   * Returns notes that are enharmonic with this note.\n   */\n  enharmonics: function(oneaccidental) {\n    var key = this.key(), limit = oneaccidental ? 2 : 3;\n\n    return ['m3', 'm2', 'm-2', 'm-3']\n      .map(this.interval.bind(this))\n      .filter(function(note) {\n      var acc = note.accidentalValue();\n      var diff = key - (note.key() - acc);\n\n      if (diff < limit && diff > -limit) {\n        var product = vector.mul(knowledge.sharp, diff - acc);\n        note.coord = vector.add(note.coord, product);\n        return true;\n      }\n    });\n  },\n\n  solfege: function(scale, showOctaves) {\n    var interval = scale.tonic.interval(this), solfege, stroke, count;\n    if (interval.direction() === 'down')\n      interval = interval.invert();\n\n    if (showOctaves) {\n      count = (this.key(true) - scale.tonic.key(true)) / 7;\n      count = (count >= 0) ? Math.floor(count) : -(Math.ceil(-count));\n      stroke = (count >= 0) ? '\\'' : ',';\n    }\n\n    solfege = knowledge.intervalSolfege[interval.simple(true).toString()];\n    return (showOctaves) ? pad(solfege, stroke, Math.abs(count)) : solfege;\n  },\n\n  scaleDegree: function(scale) {\n    var inter = scale.tonic.interval(this);\n\n    // If the direction is down, or we're dealing with an octave - invert it\n    if (inter.direction() === 'down' ||\n       (inter.coord[1] === 0 && inter.coord[0] !== 0)) {\n      inter = inter.invert();\n    }\n\n    inter = inter.simple(true).coord;\n\n    return scale.scale.reduce(function(index, current, i) {\n      var coord = Interval.toCoord(current).coord;\n      return coord[0] === inter[0] && coord[1] === inter[1] ? i + 1 : index;\n    }, 0);\n  },\n\n  /**\n   * Returns the name of the duration value,\n   * such as 'whole', 'quarter', 'sixteenth' etc.\n   */\n  durationName: function() {\n    return knowledge.durations[this.duration.value];\n  },\n\n  /**\n   * Returns the duration of the note (including dots)\n   * in seconds. The first argument is the tempo in beats\n   * per minute, the second is the beat unit (i.e. the\n   * lower numeral in a time signature).\n   */\n  durationInSeconds: function(bpm, beatUnit) {\n    var secs = (60 / bpm) / (this.duration.value / 4) / (beatUnit / 4);\n    return secs * 2 - secs / Math.pow(2, this.duration.dots);\n  },\n\n  /**\n   * Returns the name of the note, with an optional display of octave number\n   */\n  toString: function(dont) {\n    return this.name() + this.accidental() + (dont ? '' : this.octave());\n  }\n};\n\nNote.fromString = function(name, dur) {\n  var coord = scientific(name);\n  if (!coord) coord = helmholtz(name);\n  return new Note(coord, dur);\n};\n\nNote.fromKey = function(key) {\n  var octave = Math.floor((key - 4) / 12);\n  var distance = key - (octave * 12) - 4;\n  var name = knowledge.fifths[(2 * Math.round(distance / 2) + 1) % 7];\n  var subDiff = vector.sub(knowledge.notes[name], knowledge.A4);\n  var note = vector.add(subDiff, [octave + 1, 0]);\n  var diff = (key - 49) - vector.sum(vector.mul(note, [12, 7]));\n\n  var arg = diff ? vector.add(note, vector.mul(knowledge.sharp, diff)) : note;\n  return new Note(arg);\n};\n\nNote.fromFrequency = function(fq, concertPitch) {\n  var key, cents, originalFq;\n  concertPitch = concertPitch || 440;\n\n  key = 49 + 12 * ((Math.log(fq) - Math.log(concertPitch)) / Math.log(2));\n  key = Math.round(key);\n  originalFq = concertPitch * Math.pow(2, (key - 49) / 12);\n  cents = 1200 * (Math.log(fq / originalFq) / Math.log(2));\n\n  return { note: Note.fromKey(key), cents: cents };\n};\n\nNote.fromMIDI = function(note) {\n  return Note.fromKey(note - 20);\n};\n\nmodule.exports = Note;\n"},"lineCount":227}},"error":null,"hash":"d905f6a23e2ae945f1b339b9928ef1c6","cacheData":{"env":{}}}